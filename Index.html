<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#000000" />
  <link rel="icon" href="icon-192.png" />
  <title>LIAM GO PWA</title>
</head>
<body>
  <h1>Welcome to LIAM GO</h1>
  <p>This is a fully integrated PWA setup in one HTML file.</p>

  <script>
    // Manifest content
    const manifest = {
      name: "LIAM GO",
      short_name: "LIAM",
      start_url: ".",
      display: "standalone",
      background_color: "#000000",
      theme_color: "#000000",
      icons: [
        {
          src: "icon-192.png",
          sizes: "192x192",
          type: "image/png"
        },
        {
          src: "icon-512.png",
          sizes: "512x512",
          type: "image/png"
        }
      ]
    };

    // Create a Blob and inject manifest
    const manifestBlob = new Blob([JSON.stringify(manifest)], { type: 'application/json' });
    const manifestURL = URL.createObjectURL(manifestBlob);
    const link = document.createElement('link');
    link.rel = 'manifest';
    link.href = manifestURL;
    document.head.appendChild(link);

    // Service Worker content
    const swCode = `
      const CACHE_NAME = "liamgo-cache-v1";
      const urlsToCache = ["/", "/index.html", "/icon-192.png", "/icon-512.png"];

      self.addEventListener("install", (event) => {
        event.waitUntil(
          caches.open(CACHE_NAME).then((cache) => {
            return cache.addAll(urlsToCache);
          })
        );
      });

      self.addEventListener("fetch", (event) => {
        event.respondWith(
          caches.match(event.request).then((response) => {
            return response || fetch(event.request);
          })
        );
      });
    `;

    // Register the service worker
    if ('serviceWorker' in navigator) {
      const swBlob = new Blob([swCode], { type: 'application/javascript' });
      const swURL = URL.createObjectURL(swBlob);

      navigator.serviceWorker.register(swURL)
        .then(() => console.log("Service Worker registered."))
        .catch((error) => console.error("SW registration failed:", error));
    }
  </script>
</body>
</html>
